+++
title = "STF之新增页面三：先画只犬"
tags = [
    "jiansh"
]
date = "2020-03-07"
topics = [
    "jiansh",
    "STF"
]
toc = true
+++



[link on JianShu](https://www.jianshu.com/p/536d91d004a8)

[STF之新增页面三：照猫画虎](https://www.jianshu.com/p/a2a4e186fc77)画虎不成反类犬，一个页面加两天。

前天把后天接口实现了，昨天一天也没搞定到底怎么画个页面出来。最开始是参考设置页面到实现进行展示，但数据是“异步”获取回来的，没办法直接在controller里使用。

今天请教了同事，修改为“指令”方式——类似设备管理页面。改了一天：

指令方式也是数据“异步”获取到的；然后使用setTimeout方式先画页面，页面展示出来了，但每次都得强制等待。应该有传递这种异步结果的机制吧？

在知识缺乏的情况下，每一步都可能是未知的坑。下午再次请教同事之后激发了火花，使用事件触发机制。

事件上`tracker.devices.forEach(addListsner)`是干扰代码，看起来是不会进到这里执行的。而一开始我就是照着这个forEach的目标进行。

页面算是画出来了。tab页切换的时候报错，先只显示一个tab页面吧。

--- 
>感冒一周的状况昨晚突然加重，三点醒来，鼻塞嘴巴烫，一直不怎么睡得着。快五点的时候起来在屋里站桩。

今天先这样吧，步数还差很多。走起～
