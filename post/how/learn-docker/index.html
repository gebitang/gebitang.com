<!DOCTYPE html>
<html xmlns:wb="http://open.weibo.com/wb" lang="en" >

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="the way to docker">
  <meta name="generator" content="Hugo 0.74.3" />

  <title>docker practice &middot; 戈壁堂</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="http://gebitang.com/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="http://gebitang.com/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="http://gebitang.com/css/blackburn.css">

  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="http://gebitang.com/img/favicon.ico" type="image/x-icon" />

  
    
        <link rel="stylesheet" href="http://gebitang.com/css/my.css">
    
  
  
    
        <script src="http://gebitang.com/js/my.js"></script>
    
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="http://gebitang.com/">Gebitang</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://gebitang.com/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://gebitang.com/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://gebitang.com/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://gebitang.com/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://gebitang.com/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://gebitang.com/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>

  <div class="small-print">
  	<small>
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a><br/>本<span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" rel="dct:type">作品</span>由<a xmlns:cc="http://creativecommons.org/ns#" href="http://gebitang.com" property="cc:attributionName" rel="cc:attributionURL">&nbsp;Gebitang&nbsp;&nbsp;</a>采用<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">知识共享署名 4.0 国际许可协议</a>进行许可&nbsp;&copy; 2018
    </small>

  </div>

  <div class="small-print">
    <small></small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>

  <div style="display:none">
  <div class="small-print">
    <small>
    <wb:follow-button uid="2446212465" type="red_1" width="67" height="24"></wb:follow-button>
  </small>
  </div>
  </div>

</div>

</div>


  <div id="main">


<div class="header">
  <h1>docker practice</h1>
  <h2>the way to docker</h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>2020-03-23</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="http://gebitang.com/topics/docker">docker</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="http://gebitang.com/topics/tech">tech</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="http://gebitang.com/tags/docker">docker</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="http://gebitang.com/tags/tech">tech</a>
    
  </div>
  
  

</div>

  
	<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#配置docker-engine">配置docker engine</a></li>
        <li><a href="#sonar支持go工程覆盖率">Sonar支持go工程覆盖率</a></li>
        <li><a href="#系统环境变量">系统环境变量</a></li>
        <li><a href="#go-env变量">go env变量</a></li>
        <li><a href="#docker-exec--it-container-id-bash">docker exec -it container-id bash</a></li>
        <li><a href="#docker-compose-with-example">Docker Compose with example</a>
          <ul>
            <li><a href="#elasticsearch">ElasticSearch</a></li>
            <li><a href="#etcd">etcd</a></li>
            <li><a href="#调用链">调用链</a></li>
          </ul>
        </li>
        <li><a href="#删除container">删除container</a></li>
        <li><a href="#cannot-create-container-for-service-filebeat-drive-has-not-been-shared">Cannot create container for service filebeat: Drive has not been shared</a></li>
        <li><a href="#slow-on-windows">slow on Windows</a></li>
      </ul>
    </li>
    <li><a href="#由浅入深吃透-docker">由浅入深吃透 Docker</a></li>
  </ul>
</nav>
  

  <p><a href="https://docker_practice.gitee.io/">Docker — 从入门到实践</a>, <a href="https://github.com/gebitang/docker_practice">Source</a></p>
<p>这篇留在这里已经快一年了，也没啥动静。还是得**“业务”**驱动。</p>
<h3 id="配置docker-engine">配置docker engine</h3>
<p>默认的配置文件<code>insecure-registries</code>和<code>registry-mirrors</code>都为空，本地私服和公网镜像可以添加到配置中，类似——</p>
<pre><code>{
  &quot;builder&quot;: {
    &quot;gc&quot;: {
      &quot;defaultKeepStorage&quot;: &quot;20GB&quot;,
      &quot;enabled&quot;: true
    }
  },
  &quot;experimental&quot;: false,
  &quot;features&quot;: {
    &quot;buildkit&quot;: true
  },
  &quot;insecure-registries&quot;: [
    &quot;hub.xxx.com&quot;
  ],
  &quot;registry-mirrors&quot;: [
    &quot;https://nmhwesdd.mirror.aliyuncs.com&quot;
  ]
}

</code></pre><h3 id="sonar支持go工程覆盖率">Sonar支持go工程覆盖率</h3>
<p><a href="../../../post/2020/0319-sonar-go-with-coverage/">Sonar实践问题：支持go工程的覆盖率</a>本地执行跑完了简易流程。线上使用时要求：Java环境+Go环境</p>
<p>Go环境的配置比较简单，所以就Java的环境上新做一个镜像。</p>
<p>使用私有仓库：hub.mytest.com</p>
<ul>
<li>查看本地现有的镜像<code>docker images</code></li>
<li>拉取一个Java8-latest的镜像 <code>docker pull hub.mytest.com/library/java:8-latest</code></li>
<li>启动容器<code>docker run -it image-id</code> （i for interactive, t for terminal)</li>
<li>搭建go环境：</li>
<li>下载  <code>wget https://dl.google.com/go/go1.14.1.linux-amd64.tar.gz</code></li>
<li>解压  <code>tar -C /usr/local -xzf go1.14.1.linux-amd64.tar.gz</code></li>
<li>配置变量 <code>echo 'export GOPATH=/usr/local/go '&gt;&gt;/root/.bashrc; echo 'export export PATH=$GOPATH/bin:$PATH'&gt;&gt;/root/.bashrc</code></li>
<li>退出docker，使用commit创建新的镜像 <code>docker commit 96dac7c6b872 javaWithGoEnv:0.1</code></li>
<li>添加tag并上传到私有仓库：<code>docker tag javaWithGoEnv:0.1 hub.mytest.com/gebitang/javaWithGoEnv:0.1; docker push hub.mytest.com/gebitang/javaWithGoEnv:0.1</code></li>
</ul>
<p>验证上传的镜像：</p>
<ul>
<li>登录 <code>docker login hub.mytest.com</code> (windows环境下直接使用 双引号可以识别用户名密码；Mac环境下特殊字符会被截断，可以不直接使用-u -p参数)</li>
<li>执行并验证go环境<code>docker run -it imageid; go version</code></li>
</ul>
<pre><code>exit;
#列出容器操作记录
$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                         PORTS               NAMES
96dac7c6b872        2b5cf8a5a385        &quot;/bin/bash&quot;         5 minutes ago       Exited (130) 3 seconds ago                         wonderful_knuth
5da89c979e26        2b5cf8a5a385        &quot;/bin/bash&quot;         About an hour ago   Up About an hour                                   hardcore_hugle
2fd722989ad4        2b5cf8a5a385        &quot;/bin/bash&quot;         About an hour ago   Exited (0) About an hour ago                       trusting_lewin
a159c52429eb        b3fa0f1247c1        &quot;/bin/bash&quot;         About an hour ago   Exited (0) About an hour ago                       quirky_shirley
962f0252e8b0        1b261c693e4b        &quot;/bin/bash&quot;         2 hours ago         Exited (0) 2 hours ago                             clever_bohr
dda1589c78cf        5197ffb8c58f        &quot;bash&quot;              2 hours ago         Exited (0) 2 hours ago                             nifty_golick

$ docker commit --help
Usage:  docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]

Create a new image from a container's changes

$ docker tag --help
Usage:  docker tag SOURCE_IMAGE[:TAG] TARGET_IMAGE[:TAG]

Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE

$ docker login --help
Usage:  docker login [OPTIONS] [SERVER]

Log in to a Docker registry

</code></pre><hr>
<pre><code>opensources curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add - 
OK
</code></pre><hr>
<p>还没学会如何使用DockerFile<a href="https://docs.docker.com/develop/develop-images/baseimages/">从头开始</a>创建docker镜像。业务需要，直接从本地的容器里进行环境更新。</p>
<h3 id="系统环境变量">系统环境变量</h3>
<p>目前的环境需要——</p>
<ul>
<li>Java</li>
<li>sonar-scanner</li>
<li>sonar-scanner-eslint （前端扫描自定义的sonar）</li>
<li>eslint-cars-server （前端封装后的服务）</li>
<li>node</li>
<li>go</li>
</ul>
<p>使用root用户，将需要的环境变量添加到<code>/etc/profile</code>和<code>/root/.bashrc</code>文件下，类似——</p>
<pre><code>export JAVA_HOME=/usr/java/jdk1.8.0_231-amd64
export GOROOT=/usr/local/go
export GOPATH=/go
export PATH=/usr/local/nodejs/node-v0.10.13-linux-x64/bin:$JAVA_HOME/bin:$GOROOT/bin:$PATH
</code></pre><p>从terminal里启动是没有问题，但上述配置在docker环境启动后没有生效。默认的PATH只识别 <code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin </code>这些内容。</p>
<p>可以使用软连接的方式，在现有的PATH路径下创建新的软连接——</p>
<pre><code>ln -s /usr/local/go/bin/go /usr/local/bin/go
ln -s /usr/local/nodejs/node-v10.13.0-linux-x64/bin/node /usr/local/bin/node
ln -s /usr/local/nodejs/node-v10.13.0-linux-x64/bin/npm /usr/local/bin/npm
ln -s /usr/local/nodejs/node-v10.13.0-linux-x64/bin/eslint-cars-server /usr/local/bin/eslint-cars-server


ls -l /usr/local/bin/
total 8
lrwxrwxrwx 1 root root   20 Apr 14 04:59 go -&gt; /usr/local/go/bin/go
lrwxrwxrwx 1 root root   50 Apr 14 05:23 node -&gt; /usr/local/nodejs/node-v10.13.0-linux-x64/bin/node
lrwxrwxrwx 1 root root   49 Apr 14 05:23 npm -&gt; /usr/local/nodejs/node-v10.13.0-linux-x64/bin/npm
-rwxr-xr-x 1 root root 1771 Apr 13 07:05 sonar-scanner
-rwxr-xr-x 1 root root  610 Apr 13 07:05 sonar-scanner-debug
</code></pre><h3 id="go-env变量">go env变量</h3>
<p>默认的配置如下——</p>
<pre><code>GO111MODULE=&quot;&quot;
GOARCH=&quot;amd64&quot;
GOBIN=&quot;&quot;
GOCACHE=&quot;/root/.cache/go-build&quot;
GOENV=&quot;/root/.config/go/env&quot;
...
...
</code></pre><p>相同的问题，更新go env相关的变量时，采取上面更新配置文件的的方式依然无法生效。</p>
<p>观察默认的变量有个值为<code>GOENV=&quot;/root/.config/go/env&quot;</code>，手动验证一下<code>go env -w GOPRIVATE=&quot;golang.my.test.com&quot;</code>，这个值会直接保存在GOENV对应的文件下。</p>
<p>所有可以采用这种方式更新需要的go env变量</p>
<h3 id="docker-exec--it-container-id-bash">docker exec -it container-id bash</h3>
<p><a href="https://stackoverflow.com/a/26496854/1087122">How to enter in a Docker container already running with a new TTY</a></p>
<h3 id="docker-compose-with-example">Docker Compose with example</h3>
<p><a href="https://docs.docker.com/compose/compose-file">Compose file version 3 reference</a></p>
<ul>
<li>
<p>执行<code>docker-compose up</code>，启动一个服务 <a href="https://docs.docker.com/compose/gettingstarted/">Get started with Docker Compose</a></p>
</li>
<li>
<p>服务由当前目录下的 <code>docker-compose.yml</code>文件进行定义</p>
</li>
<li>
<p>服务定义中的<code>build</code>阶段可以定义<code>DOCKERFILE</code>文件</p>
</li>
<li>
<p>可以使用当前目录下的 <code>.env</code> 文件作为参数定义环境变量 <a href="https://docs.docker.com/compose/environment-variables/">Environment variables in Compose</a></p>
</li>
<li>
<p>使用<code>docker-compose up --build </code>重新构建镜像，然后再启动（这一步让项目可以正常运行起来）</p>
</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml"><span style="color:#66d9ef">version</span>: <span style="color:#e6db74">&#39;3&#39;</span>
<span style="color:#66d9ef">services</span>:
  <span style="color:#66d9ef">web</span>:
    <span style="color:#66d9ef">build</span>:
      <span style="color:#66d9ef">context</span>: .
      <span style="color:#66d9ef">dockerfile</span>: <span style="color:#e6db74">&#34;${DOCKERFILE}&#34;</span>
    <span style="color:#66d9ef">ports</span>:
      - <span style="color:#e6db74">&#34;5000:5000&#34;</span>
    <span style="color:#75715e"># bind mount. dymaticly change code</span>
    <span style="color:#66d9ef">volumes</span>:
      - .:/code
  <span style="color:#66d9ef">redis</span>:
    <span style="color:#66d9ef">image</span>: <span style="color:#e6db74">&#34;redis:alpine&#34;</span>

</code></pre></div><p>其他定义并使用变量的方法——</p>
<ul>
<li>使用shell环境下的变量，例如<code>POSTGRES_VERSION=9.3</code>，则下面的postgres的版本将使用9.3版本</li>
</ul>
<pre><code>db:
  image: &quot;postgres:${POSTGRES_VERSION}&quot;
</code></pre><ul>
<li>使用<code>-e</code>参数，例如 <code>docker compose run -e VARIABLE=VALUE </code></li>
</ul>
<p>强制重新编译生效：</p>
<ul>
<li>执行<code>docker-compose build --no-cache</code> 重新编译主程序</li>
<li>启动服务<code>docker-compose up --build</code> 先执行编译，再启动服务。（会自动判断与cache相比是否有更新？）</li>
</ul>
<p>WARNING: Image for service xxx was built because it did not already exist. To rebuild this image you must use <code>docker-compose build</code> or <code>docker-compose up --build</code>.</p>
<h4 id="elasticsearch">ElasticSearch</h4>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-search.html">ElasticSearch API：</a></p>
<pre><code>GET /&lt;index&gt;/_search

GET /_search

POST /&lt;index&gt;/_search

POST /_search
</code></pre><ul>
<li>发送数据 <code> curl -H &quot;Content-Type: application/json&quot; -XPOST &quot;http://localhost:9200/filebeat-6.4.3-2020.07.31/doc&quot; -d $info</code></li>
<li>查询数据 <code>curl http://localhost:9200/filebeat-6.4.3-2020.07.31/_search</code></li>
<li>通过proxy发送数据 <code>curl -H &quot;Content-Type: application/x-ndjson&quot; -XPOST &quot;http://localhost:9200/_bulk&quot; -d $info</code></li>
</ul>
<p>先将<code>ndjson</code>类型的数据读入到变量info中，<code>info=$(cat data.info)</code>。</p>
<blockquote>
<p><a href="https://github.com/ndjson/ndjson-spec">NDJSON - Newline delimited JSON</a><br>
Consists of individual lines where each individual line is any valid JSON text and each line is delimited with a newline character.</p>
</blockquote>
<p>ES中调用<code>_bulk</code>接口时，默认使用这种类型。<a href="https://github.com/elastic/elasticsearch-py/issues/609">https://github.com/elastic/elasticsearch-py/issues/609</a></p>
<h4 id="etcd">etcd</h4>
<blockquote>
<p><a href="https://github.com/etcd-io/etcd">etcd:</a> Distributed reliable key-value store for the most critical data of a distributed system</p>
</blockquote>
<p>从<a href="https://github.com/etcd-io/etcd/releases/latest">https://github.com/etcd-io/etcd/releases/latest</a>下载对应操作系统的最新版本，目前(2020-08-12)为<code>3.4.10</code>版本。</p>
<p>解压后将对应的目录添加到环境变量，或直接到对应目录下使用。</p>
<p>（go编译打包的服务优势：windows下也只需要一个exe文件就可以直接使用——永远的“绿色免安装”版本）</p>
<ul>
<li>解压安装</li>
<li><code>etcd.exe --version</code>查看版本</li>
<li>启动etcd，<code>etcd.exe</code>执行起来。</li>
<li>检查<code>etcdctl.exe member list</code></li>
</ul>
<p>添加key，查找key对应的值。可以使用endpoints参数指定连接的server地址</p>
<pre><code>D:\tools\etcd-v3.4.10-windows-amd64&gt;etcd.exe --version
etcd Version: 3.4.10
Git SHA: 18dfb9cca
Go Version: go1.12.17
Go OS/Arch: windows/amd64

D:\tools\etcd-v3.4.10-windows-amd64&gt;etcdctl.exe --endpoints=127.0.0.1:2379 put testKey &quot;value of testKey&quot;
OK

D:\tools\etcd-v3.4.10-windows-amd64&gt;etcdctl.exe --endpoints=127.0.0.1:2379 get testKey
testKey
value of testKey

</code></pre><p>Watcher功能可用来实现动态控制功能。</p>
<p><a href="https://programmer.help/blogs/a-concise-tutorial-of-golang-etcd.html">A concise tutorial of golang etcd</a></p>
<p><a href="https://segmentfault.com/a/1190000020742981">etcd架构介绍</a></p>
<p><a href="https://segmentfault.com/a/1190000020787391">etcd常用操作介绍</a></p>
<p><a href="https://etcd.io/docs/v3.4.0/demo/">etcd demo</a></p>
<h4 id="调用链">调用链</h4>
<pre><code>//调用链
main.go --&gt; init() --&gt; newServerCmd() *cobra.Command
//异步执行，进入实际业务逻辑
// confPath路径固定？ /etc/esproxy/config.toml
// server.go
serveProxy() --&gt; 
    InitProxyMux() ——初始化内容过多:(
    wrapperMiddleware 添加http请求的中间件

decode -&gt; processor chains -&gt; encode -&gt; dispatchToES

cmd/inject/log_pipeline_inject.go

pre Chain： 
    alerterPipeline
    routePipeline
    ratelimitePipeline

pos Chain:
    courierPipeline

//依赖的组件包括：组件工作的关系？应用的场景
grafana
kafka
mysql
prometheus
etcd
elasticsearch
filebeat
redis
</code></pre><h3 id="删除container">删除container</h3>
<p><a href="https://docs.docker.com/engine/reference/commandline/rm/">docker rm</a></p>
<p><a href="https://linuxize.com/post/how-to-remove-docker-images-containers-volumes-and-networks">Remove Docker Containers, Images, Volumes, and Networks</a></p>
<pre><code># list all containers 
docker container ls -a

# remove container id
docker container rm cc3f2ff51cab cd20b396a061

# remove all stopped containers 
docker container prune
</code></pre><h3 id="cannot-create-container-for-service-filebeat-drive-has-not-been-shared">Cannot create container for service filebeat: Drive has not been shared</h3>
<p>windows环境下使用<code>docker-compose up</code>时报错，提示类似<code>Cannot create container for service filebeat: Drive has not been shared</code>的错误。</p>
<p><a href="https://github.com/Cyb3rWard0g/HELK/issues/79#issuecomment-397637262">解决方案</a> ，包含<a href="https://github.com/docker/compose/issues/4303">官方issue #4303</a></p>
<ul>
<li>环境变量设置正确，<code>.env</code>文件中设置环境变量<code>COMPOSE_CONVERT_WINDOWS_PATHS=1</code>，或者在命令行执行 <code>set COMPOSE_CONVERT_WINDOWS_PATHS=1</code>\</li>
<li>设置settings的Shared Dreives选项<code> Windows settings &gt; Shared Drives &gt; Reset credentials &gt; select drive &gt; Apply</code></li>
<li>正确配置了windows下docker的share volumns，参考<a href="https://docs.microsoft.com/en-us/archive/blogs/stevelasker/configuring-docker-for-windows-volumes">微软的说明</a></li>
</ul>
<h3 id="slow-on-windows">slow on Windows</h3>
<p>相同版本，相同docker配置（2核2G）。Windows上宿主机更强（Intel Core i7-8700 3.2GHz / 32GB Memory），Mac（Intel Core i5/ 8GB Memory）</p>
<p>Docker Community Edition</p>
<ul>
<li>Version 17.06.2-ce-win27 (13194) Channel: stable 428bd6c</li>
<li>Version 17.06.0-ce-mac18 (18433) Channel: stable d9b66511e0</li>
</ul>
<p>跑相同的compose工程。启动速度Windows上差一大截，<a href="https://github.com/docker/for-win/issues/1936">官方issue</a>吐槽，有人<a href="https://github.com/docker/for-win/issues/1936#issuecomment-380257581">建议</a>——</p>
<p><strong>Here are directories to exclude</strong></p>
<ul>
<li>development project directories that contain .git repos or node_modules, etc</li>
<li>docker image directories</li>
<li>anything with thousdands of files</li>
</ul>
<p><strong>What services to configure exclusions on</strong></p>
<ul>
<li>add directory to Windows Defender Exclusion list <a href="https://support.microsoft.com/en-us/help/4028485/windows-10-add-an-exclusion-to-windows-defender-antivirus">https://support.microsoft.com/en-us/help/4028485/windows-10-add-an-exclusion-to-windows-defender-antivirus</a></li>
<li>add directory to Windows Indexing exclusion list&ndash; Control Panel -&gt; Indexing Options -&gt; Add all of your development directories</li>
</ul>
<p>别瞎折腾了，迁移到Mac/Linux上跑不香吗~</p>
<h2 id="由浅入深吃透-docker">由浅入深吃透 Docker</h2>
<p><a href="https://kaiwu.lagou.com/course/courseInfo.htm?courseId=455">1元课程：</a></p>
<p>Docker 是利用 Linux 的 Namespace 、Cgroups 和联合文件系统三大机制来保证实现的：使用 Namespace 做主机名、网络、PID 等资源的隔离，使用 Cgroups 对进程或者进程组做资源（例如：CPU、内存等）的限制，联合文件系统用于镜像构建和容器运行环境。</p>

  
  

  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="http://gebitang.com/post/2020/0319-sonar-go-with-coverage/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="http://gebitang.com/post/2020/0319-sonar-go-with-coverage/">Sonar实践问题：支持go工程的覆盖率</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="http://gebitang.com/post/2020/0324-usage-of-jgit/">JGit 支持推送</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="http://gebitang.com/post/2020/0324-usage-of-jgit/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'gebitang';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</div>

</div>
</div>
<script src="http://gebitang.com/js/ui.js"></script>
<script src="http://gebitang.com/js/menus.js"></script>


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-34303694-1', 'auto');
    ga('send', 'pageview');
  }
</script>




<button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
</body>
</html>

