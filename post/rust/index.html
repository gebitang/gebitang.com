<!doctype html><html xmlns:wb=http://open.weibo.com/wb lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Lean Rust"><meta name=generator content="Hugo 0.97.3"><title>Rust &#183; æˆˆå£å ‚</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css><!--[if lte IE 8]><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css><!--<![endif]--><!--[if lte IE 8]><link rel=stylesheet href=http://gebitang.com/css/side-menu-old-ie.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=http://gebitang.com/css/side-menu.css><!--<![endif]--><link rel=stylesheet href=http://gebitang.com/css/blackburn.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.9.0/css/all.css><link href="https://fonts.googleapis.com/css?family=Raleway" rel=stylesheet type=text/css><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js></script>
<script>hljs.initHighlightingOnLoad()</script><link rel="shortcut icon" href=http://gebitang.com/img/favicon.ico type=image/x-icon><link rel=stylesheet href=http://gebitang.com/css/my.css><script src=http://gebitang.com/js/my.js></script></head><body><div id=layout><a href=#menu id=menuLink class=menu-link><span></span></a><div id=menu><a class="pure-menu-heading brand" href=http://gebitang.com/>Gebitang</a><div class=pure-menu><ul class=pure-menu-list><li class=pure-menu-item><a class=pure-menu-link href=http://gebitang.com/><i class="fa fa-home fa-fw"></i>Home</a></li><li class=pure-menu-item><a class=pure-menu-link href=http://gebitang.com/post/><i class="fa fa-list fa-fw"></i>Posts</a></li><li class=pure-menu-item><a class=pure-menu-link href=http://gebitang.com/about/><i class="fa fa-user fa-fw"></i>About</a></li><li class=pure-menu-item><a class=pure-menu-link href=http://gebitang.com/contact/><i class="fa fa-phone fa-fw"></i>Contact</a></li><li class=pure-menu-item><a class=pure-menu-link href=http://gebitang.com/tags/><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class=pure-menu-item><a class=pure-menu-link href=http://gebitang.com/topics/><i class="fa fa-folder fa-fw"></i>Topics</a></li></ul></div><div class="pure-menu social"><ul class=pure-menu-list></ul></div><div><div class=small-print><small><a rel=license href=http://creativecommons.org/licenses/by/4.0/><img alt=çŸ¥è¯†å…±äº«è®¸å¯åè®® style=border-width:0 src=https://i.creativecommons.org/l/by/4.0/80x15.png></a><br>æœ¬<span xmlns:dct=http://purl.org/dc/terms/ href=http://purl.org/dc/dcmitype/Text rel=dct:type>ä½œå“</span>ç”±<a xmlns:cc=http://creativecommons.org/ns# href=http://gebitang.com property="cc:attributionName" rel=cc:attributionurl>&nbsp;Gebitang&nbsp;&nbsp;</a>é‡‡ç”¨<a rel=license href=http://creativecommons.org/licenses/by/4.0/>çŸ¥è¯†å…±äº«ç½²å 4.0 å›½é™…è®¸å¯åè®®</a>è¿›è¡Œè®¸å¯&nbsp;&copy; 2018</small></div><div class=small-print><small></small></div><div class=small-print><small>Built with&nbsp;<a href=https://gohugo.io/ target=_blank>Hugo</a></small>
<small>Theme&nbsp;<a href=https://github.com/yoshiharuyamashita/blackburn target=_blank>Blackburn</a></small></div><div style=display:none><div class=small-print><small><wb:follow-button uid=2446212465 type=red_1 width=67 height=24></wb:follow-button></small></div></div></div></div><div id=main><div class=header><h1>Rust</h1><h2>Lean Rust</h2></div><div class=content><div class=post-meta><div><i class="fa fa-calendar fa-fw"></i>
<time>2021-05-27</time></div><div><i class="fa fa-folder fa-fw"></i>
<a class=post-taxonomy-topic href=http://gebitang.com/topics/rust>rust</a></div><div><i class="fa fa-tags fa-fw"></i>
<a class=post-taxonomy-tag href=http://gebitang.com/tags/rust>rust</a></div></div><nav id=TableOfContents><ul><li><ul><li><a href=#å®‰è£…>å®‰è£…</a><ul><li><a href=#hello-world>Hello World</a></li></ul></li><li><a href=#ownership>Ownership</a></li></ul></li></ul></nav><p>å—<a href=https://mp.weixin.qq.com/s/jaKjzc_1rkDe67rfpnFTgg>#æœ¬åŸ ç³»åˆ—</a>å¸å¼•ï¼Œå®‰è£…äº†rustçš„windowså¼€å‘ç¯å¢ƒï¼Œç„¶åå°±æ²¡æœ‰ç„¶åäº†ã€‚ç°åœ¨æœ‰æœºä¼šè·Ÿä½œè€…<a href=https://mp.weixin.qq.com/s/tkH6zZt5vsDL2gld6ufk2w>å­¦ä¹ ä¸€ä¸‹</a></p><p>å…ˆçœ‹çœ‹<a href=https://tyrchen.github.io/rust-training/rust-training-all-in-one.html>slides</a>ï¼Œè¡¥è¡¥åŸºç¡€è¯¾â€”â€”å¥½äº›ç®€ç§°æˆ‘ä¸çŸ¥é“å•¥å«ä¹‰:)</p><ul><li>GIL (Global interpreter lock)</li><li>CSP (Communicating Sequential Processes) <a href=https://www.cs.cmu.edu/~crary/819-f09/Hoare78.pdf>åŸå§‹è®ºæ–‡</a></li><li>Duck Typing (åŠ¨æ€ç±»å‹)</li><li>RAII (Resource Acquisition Is Initialization)</li><li>FFI (Foreign Function Interface)</li><li>MRC (manual reference counting)</li><li>ARC (automatic reference counting)</li></ul><p><a href=https://coolshell.cn/articles/20845.html>RUSTè¯­è¨€çš„ç¼–ç¨‹èŒƒå¼</a>è¿™ç¯‡ä¹‹å‰çœ‹çš„æ—¶å€™æ—©æ—©å°±è¢«åŠé€€äº†ï¼Œä»Šå¤©é‡è¯»è‡³å°‘çœ‹å®Œæ²¡æ™•ã€‚å­¦ä¹ ä¸€æ®µæ—¶é—´çš„Rustä¹‹åå†é‡æ–°å»è¯»è¿™ä¸€ç¯‡:)</p><p>å­¦ä¹ Rustä¼šâ€œé¢å¯¹ç¼–è¯‘å™¨ç¼–ç¨‹â€ï¼Œéœ€è¦ä¸€å¼€å§‹å°±é¢å¯¹æ‰€æœ‰çš„åŸºç¡€çŸ¥è¯†ã€‚<a href=https://lisha.ufsc.br/teaching/os/exercise/hello.html>The True Story of Hello World</a> ä»‹ç»â€œhello worldâ€çš„ä¸€ç”Ÿã€‚æ¶‰åŠåˆ°<a href=https://stackoverflow.com/questions/2223261/bss-stack-heap-data-code-text-where-each-of-these-start-in-memory>BSS, Stack, Heap, Data, Code/Text - Where each of these start in memory?</a>ï¼Œ<a href=https://imgur.com/a/JEObT>å›¾ç‰‡è¯´æ˜</a></p><h3 id=å®‰è£…>å®‰è£…</h3><p><a href=https://www.rust-lang.org/tools/install>rust å®‰è£…</a>â€”â€”</p><ul><li>Windows: ä¸‹è½½<code>rusti-init.ext</code>è¿›è¡Œå®‰è£…ï¼Œé»˜è®¤é€‰é¡¹ï¼Œå®‰è£…å®Œæ¯•å°±å¯ä»¥ä½¿ç”¨</li><li>ç±»Unixå¹³å°ï¼šæ‰§è¡Œ<code>curl https://sh.rustup.rs -sSf | sh</code></li></ul><p>å®‰è£…å®Œæˆåï¼Œæ·»åŠ ç¯å¢ƒå˜é‡ã€‚å…¶ä¸­<code>.cargo/bin</code>ç›®å½•åŒ…å«æ‰€æœ‰çš„å·¥å…·â€”â€”</p><ul><li><code>rustup</code>ç®¡ç†rustå·¥å…·æœ¬èº«ï¼š<a href=https://github.com/rust-lang/rustup>rustup</a>æ˜¯ä¸€ä¸ª<code>the rust toolchain installer</code> ç”¨æ¥å®‰è£…rustä»¥åŠå¯¹äºçš„å·¥å…·ç»„ä»¶ã€‚æ›´è¯¦ç»†å†…å®¹å‚è€ƒ<a href=https://rust-lang.github.io/rustup/installation/index.html>rustup book</a></li><li><code>rustc</code>ç›¸å½“äºç±»ä¼¼gccçš„ç¼–è¯‘å™¨ï¼Œå•ä¸ªæ–‡ä»¶ç¼–è¯‘</li><li><code>Cargo</code> æ˜¯ rust çš„æ„å»ºç³»ç»Ÿå’ŒåŒ…ç®¡ç†å™¨ï¼Œç›¸å½“äºå·¥ç¨‹æŠ“æ‰‹</li></ul><h4 id=hello-world>Hello World</h4><ul><li>å•ä¸ªæ— ä¾èµ–çš„rustæ–‡ä»¶å¯ä»¥ä½¿ç”¨<code>rustc main.rs</code>è¿›è¡Œç¼–è¯‘ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</li><li>é¡¹ç›®ç®¡ç†ä½¿ç”¨<code>cargo</code>(ä¸åŒå¹³å°ä¸‹ï¼Œå‘½ä»¤ç›¸åŒ)ï¼š<ul><li><code>cargo build</code> è§£æcargo.tomlæ–‡ä»¶ï¼Œç®¡ç†ä¸‹è½½ï¼Œç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œé»˜è®¤ç”Ÿæˆçš„ä¸ºdebugç‰ˆæœ¬ï¼Œä½äº<code>target/debug</code>ç›®å½•ä¸‹</li><li><code>cargo check</code> åªåšç¼–è¯‘æ£€æŸ¥ï¼Œä¸ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œé€Ÿåº¦æ›´å¿«</li><li><code>cargo run</code> ç¼–è¯‘+è¿è¡Œ</li><li><code>cargo build --release</code>ç”Ÿæˆä¼˜åŒ–åçš„å‘å¸ƒç‰ˆæœ¬ï¼Œä½äº<code>target/release</code>ç›®å½•ä¸‹ï¼Œç¼–è¯‘æ›´è€—æ—¶</li><li><code>cargo doc --open</code>å¯ä»¥æœ¬åœ°æµè§ˆå½“å‰é¡¹ç›®ä¸­ç”¨åˆ°çš„æ‰€æœ‰crateçš„æ–‡æ¡£</li></ul></li></ul><p><a href=https://doc.rust-lang.org/cargo/>cargo å®˜æ–¹æ–‡æ¡£</a></p><ul><li>ä¸¤ç±»æ•°æ®ç±»å‹å­é›†ï¼šæ ‡é‡ï¼ˆscalarï¼‰å’Œå¤åˆï¼ˆcompoundï¼‰<ul><li>å››ç§åŸºæœ¬çš„æ ‡é‡ç±»å‹ï¼šæ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”ç±»å‹å’Œå­—ç¬¦ç±»å‹</li><li>ä¸¤ä¸ªåŸç”Ÿçš„å¤åˆç±»å‹ï¼šå…ƒç»„ï¼ˆtupleï¼‰å’Œæ•°ç»„ï¼ˆarrayï¼‰</li></ul></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//let x = 5;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> x <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;the value of x is {}&#34;</span>, x);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    x <span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;the value of x is {}&#34;</span>, x);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> MAX_POINT: <span style=color:#66d9ef>u32</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>100_000</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;max point is {}&#34;</span>, MAX_POINT);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> y <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> y <span style=color:#f92672>=</span> y <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> y <span style=color:#f92672>=</span> y <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;now the value of y is {}&#34;</span>, y);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> space <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;abc&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> space <span style=color:#f92672>=</span> space.len();
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;the length of space is {}&#34;</span>, space);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// åŠ æ³•
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> sum <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å‡æ³•
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> difference <span style=color:#f92672>=</span> <span style=color:#ae81ff>95.5</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>4.3</span>;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ä¹˜æ³•
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> product <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>30</span>;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// é™¤æ³•
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> quotient <span style=color:#f92672>=</span> <span style=color:#ae81ff>56.7</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>32.2</span>;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å–ä½™
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> remainder <span style=color:#f92672>=</span> <span style=color:#ae81ff>43</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>5</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;sum:{} difference:{} product:{}, quatient:{} remainder:{}&#34;</span>, sum, difference, product, quotient, remainder);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// char ç±»å‹çš„å¤§å°ä¸ºå››ä¸ªå­—èŠ‚(four bytes)ï¼Œå¹¶ä»£è¡¨äº†ä¸€ä¸ª Unicode æ ‡é‡å€¼ï¼ˆUnicode Scalar Value)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> c <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;z&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> z <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;â„¤&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> heart_eyed_cat <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ğŸ˜»&#39;</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;c:{} z:{} hec:{}&#34;</span>, c, z, heart_eyed_cat);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//å…ƒç»„é•¿åº¦å›ºå®šï¼šä¸€æ—¦å£°æ˜ï¼Œå…¶é•¿åº¦ä¸ä¼šå¢å¤§æˆ–ç¼©å°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> tup: (<span style=color:#66d9ef>i32</span>, <span style=color:#66d9ef>f64</span>, <span style=color:#66d9ef>u8</span>) <span style=color:#f92672>=</span> (<span style=color:#ae81ff>500</span>, <span style=color:#ae81ff>6.4</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> (x, y, z) <span style=color:#f92672>=</span> tup; <span style=color:#75715e>// ignore x and z
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;The value of x is: {} = {}&#34;</span>, tup.<span style=color:#ae81ff>0</span>, x);
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;The value of y is: {} = {}&#34;</span>, tup.<span style=color:#ae81ff>1</span>, y);
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;The value of z is: {} = {}&#34;</span>, tup.<span style=color:#ae81ff>2</span>, z);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> tup <span style=color:#f92672>=</span> (<span style=color:#e6db74>&#34;abc&#34;</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;the first tuple value: {}&#34;</span>, tup.<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Rust ä¸­çš„æ•°ç»„æ˜¯å›ºå®šé•¿åº¦çš„ï¼šä¸€æ—¦å£°æ˜ï¼Œå®ƒä»¬çš„é•¿åº¦ä¸èƒ½å¢é•¿æˆ–ç¼©å°ã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> months <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;January&#34;</span>, <span style=color:#e6db74>&#34;February&#34;</span>, <span style=color:#e6db74>&#34;March&#34;</span>, <span style=color:#e6db74>&#34;April&#34;</span>, <span style=color:#e6db74>&#34;May&#34;</span>, <span style=color:#e6db74>&#34;June&#34;</span>, <span style=color:#e6db74>&#34;July&#34;</span>,
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#34;August&#34;</span>, <span style=color:#e6db74>&#34;September&#34;</span>, <span style=color:#e6db74>&#34;October&#34;</span>, <span style=color:#e6db74>&#34;November&#34;</span>, <span style=color:#e6db74>&#34;December&#34;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> a: [<span style=color:#66d9ef>i32</span>; <span style=color:#ae81ff>5</span>] <span style=color:#f92672>=</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;print a: {}&#34;</span>, a[<span style=color:#ae81ff>2</span>]);
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;print month {}&#34;</span>, months[<span style=color:#ae81ff>3</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// åŒ…å« 5 ä¸ªå…ƒç´ ï¼Œè¿™äº›å…ƒç´ çš„å€¼æœ€åˆéƒ½å°†è¢«è®¾ç½®ä¸º 3
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> a <span style=color:#f92672>=</span> [<span style=color:#ae81ff>3</span>; <span style=color:#ae81ff>5</span>];
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;len: {}&#34;</span>, a.len());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// let a = [1, 2, 3, 4, 5];
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// let index = 10;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// let element = a[index];
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// println!(&#34;The value of element is: {}&#34;, element);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    another_function(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> x <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> y <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> x <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>        x <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span> <span style=color:#75715e>//è¡¨è¾¾å¼çš„ç»“å°¾åŠ ä¸Šåˆ†å·ï¼Œå®ƒå°±å˜æˆäº†è¯­å¥ï¼Œè€Œè¯­å¥ä¸ä¼šè¿”å›å€¼
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;The value of y is: {} x:{}&#34;</span>, y, x);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;five func return {}&#34;</span>, five());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;plus one func return {}&#34;</span>, plus_one(<span style=color:#ae81ff>7</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> condition <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> number <span style=color:#f92672>=</span> <span style=color:#66d9ef>if</span> condition {
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;The value of number is: {}&#34;</span>, number);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> counter <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> result <span style=color:#f92672>=</span> <span style=color:#66d9ef>loop</span> {
</span></span><span style=display:flex><span>        counter <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> counter <span style=color:#f92672>==</span> <span style=color:#ae81ff>10</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span> counter <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;The result is {}&#34;</span>, result);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// for å¾ªç¯
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> a <span style=color:#f92672>=</span> [<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>40</span>, <span style=color:#ae81ff>50</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> element <span style=color:#66d9ef>in</span> a.iter() {
</span></span><span style=display:flex><span>        println!(<span style=color:#e6db74>&#34;the value is: {}&#34;</span>, element);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> number <span style=color:#66d9ef>in</span> (<span style=color:#ae81ff>1</span><span style=color:#f92672>..</span><span style=color:#ae81ff>4</span>).rev() {
</span></span><span style=display:flex><span>        println!(<span style=color:#e6db74>&#34;{}!&#34;</span>, number);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;LIFTOFF!!!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>another_function</span>(x: <span style=color:#66d9ef>i32</span>) {
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;this is another function. {}&#34;</span>, x);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// æ²¡æœ‰å‡½æ•°è°ƒç”¨ã€å®ã€ç”šè‡³æ²¡æœ‰ let è¯­å¥â€”â€”åªæœ‰æ•°å­— 5ã€‚è¿™åœ¨ Rust ä¸­æ˜¯ä¸€ä¸ªå®Œå…¨æœ‰æ•ˆçš„å‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>five</span>() -&gt;<span style=color:#66d9ef>i32</span> {
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åŒ…å« x + 1 çš„è¡Œå°¾åŠ ä¸Šä¸€ä¸ªåˆ†å·ï¼ŒæŠŠå®ƒä»è¡¨è¾¾å¼å˜æˆè¯­å¥ï¼Œå°†æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚mismatched types
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>plus_one</span>(x: <span style=color:#66d9ef>i32</span>) -&gt; <span style=color:#66d9ef>i32</span> {
</span></span><span style=display:flex><span>    x <span style=color:#f92672>+</span><span style=color:#ae81ff>1</span> 
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=ownership>Ownership</h3><p>æ‰€æœ‰æƒï¼ˆç³»ç»Ÿï¼‰æ˜¯ Rust æœ€ä¸ºä¸ä¼—ä¸åŒçš„ç‰¹æ€§ï¼Œå®ƒè®© Rust æ— éœ€åƒåœ¾å›æ”¶ï¼ˆgarbage collectorï¼‰å³å¯ä¿éšœå†…å­˜å®‰å…¨ã€‚ç›¸å…³åŠŸèƒ½åŒ…æ‹¬ï¼šå€Ÿç”¨ã€slice ä»¥åŠ Rust å¦‚ä½•åœ¨å†…å­˜ä¸­å¸ƒå±€æ•°æ®ã€‚</p><p>ç¨‹åºç®¡ç†ä½¿ç”¨è®¡ç®—æœºå†…å­˜çš„æ–¹å¼ï¼š</p><ul><li>åƒåœ¾å›æ”¶æœºåˆ¶ã€‚å¦‚Java</li><li>æ‰‹åŠ¨åˆ†é…åˆ†é…å’Œé‡Šæ”¾å†…å­˜ã€‚å¦‚Cï¼ŒC++</li><li>æ‰€æœ‰æƒç³»ç»Ÿç®¡ç†å†…å­˜ã€‚å¦‚Rustã€‚å…¶ä¼˜ç‚¹ï¼šç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ä¼šæ ¹æ®ä¸€ç³»åˆ—çš„è§„åˆ™è¿›è¡Œæ£€æŸ¥ã€‚åœ¨è¿è¡Œæ—¶ï¼Œæ‰€æœ‰æƒç³»ç»Ÿçš„ä»»ä½•åŠŸèƒ½éƒ½ä¸ä¼šå‡æ…¢ç¨‹åº(ä¹Ÿå°±æ²¡æœ‰STWé—®é¢˜)ã€‚</li></ul><p>é¦–å…ˆè¦äº†è§£â€œæ ˆï¼ˆStackï¼‰ä¸å †ï¼ˆHeapï¼‰â€çš„å››ä¸ªä¸»è¦åŒºåˆ«â€”â€”</p><ul><li>æ ˆï¼šåè¿›å…ˆå‡ºï¼ˆlast in, first outï¼‰ï¼›æ‰€æœ‰æ•°æ®éƒ½å¿…é¡»å ç”¨å·²çŸ¥ä¸”å›ºå®šçš„å¤§å°ï¼›åˆ†é…å¿«ï¼Œ(å› ä¸ºï¼ˆå…¥æ ˆæ—¶ï¼‰æ“ä½œç³»ç»Ÿæ— éœ€ä¸ºå­˜å‚¨æ–°æ•°æ®å»æœç´¢å†…å­˜ç©ºé—´ï¼›å…¶ä½ç½®æ€»æ˜¯åœ¨æ ˆé¡¶)ï¼›è®¿é—®å¿«(å› ä¸ºå­˜å‚¨çš„è¿ç»­æ€§ï¼‰</li><li>å †ï¼šæŒ‡é’ˆè®¿é—®ï¼›æ•°æ®å¤§å°å¯èƒ½å˜åŒ–ï¼›åˆ†é…æ…¢(éœ€è¦å…ˆæœç´¢åˆ°è¶³å¤Ÿå¤§çš„ç©ºé—´ï¼›æ ‡è®°å·²ç”¨ï¼›è¿”å›æŒ‡é’ˆâ€”â€”allocating on the heap)ï¼›è®¿é—®æ…¢ï¼ˆéœ€è¦é€šè¿‡æŒ‡é’ˆè·³è½¬ï¼‰</li></ul><blockquote><blockquote><p>å½“ä»£ç è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œä¼ é€’ç»™å‡½æ•°çš„å€¼ï¼ˆåŒ…æ‹¬å¯èƒ½æŒ‡å‘å †ä¸Šæ•°æ®çš„æŒ‡é’ˆï¼‰å’Œå‡½æ•°çš„å±€éƒ¨å˜é‡è¢«å‹å…¥æ ˆä¸­ã€‚å½“å‡½æ•°ç»“æŸæ—¶ï¼Œè¿™äº›å€¼è¢«ç§»å‡ºæ ˆã€‚</p></blockquote></blockquote><p>æ‰€æœ‰æƒæ„ä¹‰ï¼š(ç®¡ç†å †æ•°æ®)</p><ul><li>è·Ÿè¸ªå“ªéƒ¨åˆ†ä»£ç æ­£åœ¨ä½¿ç”¨å †ä¸Šçš„å“ªäº›æ•°æ®</li><li>æœ€å¤§é™åº¦çš„å‡å°‘å †ä¸Šçš„é‡å¤æ•°æ®çš„æ•°é‡</li><li>æ¸…ç†å †ä¸Šä¸å†ä½¿ç”¨çš„æ•°æ®ç¡®ä¿ä¸ä¼šè€—å°½ç©ºé—´</li></ul><p>æ‰€æœ‰æƒè§„åˆ™ï¼š</p><ol><li>Rust ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªè¢«ç§°ä¸ºå…¶ æ‰€æœ‰è€…ï¼ˆownerï¼‰çš„å˜é‡ã€‚Each value in Rust has a variable thatâ€™s called its <em>owner</em>.</li><li>å€¼åœ¨ä»»ä¸€æ—¶åˆ»æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚There can only be one owner at a time.</li><li>å½“æ‰€æœ‰è€…ï¼ˆå˜é‡ï¼‰ç¦»å¼€ä½œç”¨åŸŸï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒã€‚When the owner goes out of scope, the value will be dropped.</li></ol><pre tabindex=0><code>let s1 = String::from(&#34;hello&#34;);
let s2 = s1;

println!(&#34;{}, world!&#34;, s1); // æ— æ•ˆ
println!(&#34;{}, world!&#34;, s2);
</code></pre><div class="prev-next-post pure-g"><div class=pure-u-1-24 style=text-align:left><a href=http://gebitang.com/post/2021/march-and-april/><i class="fa fa-chevron-left"></i></a></div><div class=pure-u-10-24><nav class=prev><a href=http://gebitang.com/post/2021/march-and-april/>March and April Run</a></nav></div><div class=pure-u-2-24>&nbsp;</div><div class=pure-u-10-24><nav class=next><a href=http://gebitang.com/post/2021/may-and-june/>May and June Run</a></nav></div><div class=pure-u-1-24 style=text-align:right><a href=http://gebitang.com/post/2021/may-and-june/><i class="fa fa-chevron-right"></i></a></div></div><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="gebitang",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=http://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><script src=http://gebitang.com/js/ui.js></script>
<script src=http://gebitang.com/js/menus.js></script>
<script>window.location.hostname!="localhost"&&(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-34303694-1","auto"),ga("send","pageview"))</script><button onclick=topFunction() id=myBtn title="Go to top">Top</button></body></html>